{% extends 'project_admin/base.html' %} {% block title %} Dashboard {% endblock title %}

<!-- Specific CSS goes HERE -->
{% block stylesheets %}
<style>
  /* Styling for the toast */
  .toast {
    position: fixed;
    top: 0;
    left: 50%;
    transform: translateX(-50%);
    background-color: white;
    color: var(--primary); /* Use the primary color for the words */
    opacity: 0.9;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
    padding: 15px;
    border-radius: 8px;
    z-index: 9999;
    transition: opacity 0.5s;
  }
</style>
{% endblock stylesheets %}

{% load static %}

<!-- ... existing code ... -->

{% block content %}
<div class="container mt-5">
  <h2>Feedback Form</h2>
  <form method="post">
      {% csrf_token %}
      <div class="form-group">
          <label for="form_title">Form Title:</label>
          <input type="text" class="form-control" id="form_title" name="form_title">
      </div>
      {% if form_category == 'facilities' %}
      <div class="form-group">
          <label for="facility">Select Campus Facility:</label>
          <select class="form-control" id="facility" name="facility">
              {% for facility in campus_facilities %}
                  <option value="{{ facility.facility_id }}">{{ facility.facility_name }}</option>
              {% endfor %}
          </select>
      </div>
      {% elif form_category == 'instructors' %}        
      <input type="hidden" id="instructor" name="instructor" value="">
      <!-- Add two buttons for 'instructors' form category -->
      <div class="d-flex mt-3">
        <button type="button" class="btn btn-primary" onclick="showSearchForm()">Choose Instructor</button>
        <button type="button" class="btn btn-primary mr-2" onclick="viewAllForms()">View All Forms</button>
      </div>
      {% elif form_category == 'courses' %}        
      <input type="hidden" id="course" name="course" value="">
      <!-- Add two buttons for 'courses' form category -->
      <div class="d-flex mt-3">
        <button type="button" class="btn btn-primary" onclick="showSearchForm()">Choose Course</button>
        <button type="button" class="btn btn-primary mr-2" onclick="viewAllForms()">View All Forms</button>
      </div>
      {% endif %}
      {% if form_category == 'instructors' or form_category == 'courses' %}
      <button type="submit" class="btn btn-primary mt-3">Create Form</button>
      {% else %}      
      <button type="submit" class="btn btn-primary">Create Form</button>
      {% endif %}
  </form>

  <!-- Add a div to display the selected instructor's details -->
  <div id="selected_instructor_info" class="mt-3"></div>
  <div id="selected_course_info" class="mt-3"></div>
</div>
{% if form_category == 'facilities' %}
<div class="container mt-5" id="all_forms_container">
  <h2>All Forms for Facilities</h2>
  {% if forms %}
  <ul class="list-group mt-3">
      {% for form in forms %}
      <li class="list-group-item d-flex justify-content-between align-items-center">
          {{ form.title }} for {{ form.content_object }}
          <div>
          <a href="{% url 'view_summary_data' form.id %}" class="btn btn-secondary">View Responses</a>
          <a href="{% url 'view_form' form_category form.id %}" class="btn btn-primary">View</a>
          <div>
      </li>
      {% endfor %}
  </ul>
  {% else %}
  <p>No forms available.</p>
  {% endif %}
</div>
{% elif form_category == 'instructors' %} 
<!-- Add the search bar at the end of the template -->
<div class="container mt-5" id="search_form_container">
  <h2>Search Instructors</h2>
  <form method="get">
      <div class="form-group">
          <input type="text" class="form-control" id="search_query" name="query" placeholder="Search by name or department" value="{{ search_query }}">
      </div>
      <button type="submit" class="btn btn-primary">Search</button>
  </form>
  {% if instructors %}
  <ul class="list-group mt-3">
      {% for instructor in instructors %}
      <!-- Replace the list items with clickable links to select an instructor -->
      <li class="list-group-item">
          <a href="#" onclick="selectInstructor('{{ instructor.instructor_id }}', '{{ instructor.first_name }} {{ instructor.last_name }} - {{ instructor.department }}')">
              {{ instructor.first_name }} {{ instructor.last_name }} - {{ instructor.department }}
          </a>
      </li>
      {% endfor %}
  </ul>
  {% else %}
  <p>No instructors found.</p>
  {% endif %}
</div>

<div class="container mt-5" id="all_forms_container" style="display:none;">
  <h2>All Forms for Instructors</h2>
  {% if forms %}
  <ul class="list-group mt-3">
      {% for form in forms %}
      <li class="list-group-item d-flex justify-content-between align-items-center">
          {{ form.title }} for {{ form.content_object }}
          <div>
          <a href="{% url 'view_summary_data' form.id %}" class="btn btn-secondary">View Responses</a>
          <a href="{% url 'view_form' form_category form.id %}" class="btn btn-primary">View Form</a>
          <div>
      </li>
      {% endfor %}
  </ul>
  {% else %}
  <p>No forms available.</p>
  {% endif %}
</div>

{% elif form_category == 'courses' %} 
<!-- Add the search bar at the end of the template -->
<div class="container mt-5" id="search_form_container">
  <h2>Search Courses</h2>
  <form method="get">
      <div class="form-group">
          <input type="text" class="form-control" id="search_query" name="query" placeholder="Search by course name, course code or department" value="{{ search_query }}">
      </div>
      <button type="submit" class="btn btn-primary">Search</button>
  </form>
  {% if courses %}
  <ul class="list-group mt-3">
      {% for course in courses %}
      <li class="list-group-item">
          <a href="#" onclick="selectCourse('{{ course.course_id }}', '{{ course.course_name }} {{ course.course_code }} - {{ course.department }}')">
              {{ course.course_name }} {{ course.course_code }} - {{ course.department }}
          </a>
      </li>
      {% endfor %}
  </ul>
  {% else %}
  <p>No Courses found.</p>
  {% endif %}
</div>

<div class="container mt-5" id="all_forms_container" style="display:none;">
  <h2>All Forms for Courses</h2>
  {% if forms %}
  <ul class="list-group mt-3">
      {% for form in forms %}
      <li class="list-group-item d-flex justify-content-between align-items-center">
          {{ form.title }} for {{ form.content_object }}
          <div>
            <a href="{% url 'view_summary_data' form.id %}" class="btn btn-secondary">View Responses</a>
            <a href="{% url 'view_form' form_category form.id %}" class="btn btn-primary">View Form</a>
            <div>
      </li>
      {% endfor %}
  </ul>
  {% else %}
  <p>No forms available.</p>
  {% endif %}
</div>
{% endif %}
{% endblock %}

<!-- Specific JS goes HERE -->
{% block javascripts %}
<script>
  function selectInstructor(instructorId, instructorName) {
    // Set the value of the hidden input field to the selected instructor's ID
    document.getElementById('instructor').value = instructorId;
    
    // Display the selected instructor's details in the div
    var instructorInfoDiv = document.getElementById('selected_instructor_info');
    instructorInfoDiv.innerHTML = `
      <p><strong>Selected Instructor:</strong> ${instructorName}</p>
      <p><strong>Instructor ID:</strong> ${instructorId}</p>
      <!-- Add more instructor details if needed -->
    `;
  }
  function selectCourse(courseId, courseName) {
    // Set the value of the hidden input field to the selected course's ID
    document.getElementById('course').value = courseId;
    
    // Display the selected course's details in the div
    var courseInfoDiv = document.getElementById('selected_course_info');
    courseInfoDiv.innerHTML = `
      <p><strong>Selected Course:</strong> ${courseName}</p>
      <p><strong>Course ID:</strong> ${courseId}</p>
      <!-- Add more course details if needed -->
    `;
  }

  function viewAllForms() {
    // Hide the search form container and show the container with all forms for instructors
    document.getElementById('search_form_container').style.display = 'none';
    document.getElementById('all_forms_container').style.display = 'block';
  }

  function showSearchForm() {
    // Hide the container with all forms for instructors and show the search form container
    document.getElementById('all_forms_container').style.display = 'none';
    document.getElementById('search_form_container').style.display = 'block';
  }
</script>
{% endblock javascripts %}

